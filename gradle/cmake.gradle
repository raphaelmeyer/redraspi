
class CMakeTask extends DefaultTask {
  String image
  String sourceContainer
  String sourceHost
  def command
  def workspace

  @TaskAction
  def run() {
    def sourceHostAbsolute = new File(sourceHost).absolutePath
    project.exec {
      executable = 'docker'
      args = [ 'run', '--rm', '-t', '--volumes-from', workspace.id, '-v', "${sourceHostAbsolute}:${sourceContainer}:ro", image, 'cmake'] + command
    }
  }
}

ext.CMakeTask = CMakeTask

